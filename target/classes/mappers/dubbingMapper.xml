<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="global.sesoc.Youtube.dao.DubbingMapper">
<insert id="insertDubbing" parameterType="Dubbing">
	insert into dubbing
	(
	dubbingnum,
	title,
	content,
    useremail,
    url,
    voiceFile
	)
	values
	(
	DUBBING_SEQ.nextval,
	#{title},
	#{content},
	#{useremail},
	#{url},
	#{voiceFile}
	)
	
	</insert>



	<select id="dubbingBoard"  resultType="Dubbing">
		select d.dubbingnum, d.title, m.usernick, d.hitcount, d.recommendation, d.decommendation, d.regdate
		from dubbing d, member m
		where d.useremail = m.useremail
		order by d.dubbingnum desc
	</select>
	
	<select id="selectOneDub" parameterType="int" resultType="Dubbing">
		select 
				  d.dubbingnum
			  	, d.title
				, m.usernick
				, d.content
				, d.url
				, d.voiceFile
				, d.hitcount
				, d.recommendation
				, d.decommendation
				, d.regdate
		from dubbing d, member m
		where d.useremail = m.useremail
		and d.dubbingnum = #{dubbingnum}
	</select>
	
	
	
	<!-- 주말 -->
	<select id="replyAll" parameterType="int" resultType="Reply">
			select d.replynum, d.dubbingnum, d.useremail, d.content, d.regdate, d.blackcount, m.usernick
			from dubbingreply d, member m
			where dubbingnum = #{dubbingnum}
			and d.useremail = m.useremail
			order by replynum
	</select>
	
	<insert id="insertReply" parameterType="Reply">
		insert into dubbingreply
		(replynum, dubbingnum, useremail, content)
		values 
		(DUBBING_REPLY_SEQ.NEXTVAL, #{dubbingnum},#{useremail}, #{content})
	</insert>
	
	<delete id="replyDelete" parameterType="int">
		delete from dubbingreply
		where replynum = #{replynum}
	</delete>
	
	<update id="replyUpdate" parameterType="Reply">
		update dubbingreply
		set content = #{content} , regdate = sysdate
		where replynum = #{replynum}
	</update>
</mapper>