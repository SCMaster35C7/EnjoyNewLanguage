<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="global.sesoc.Youtube.dao.InvestigationMapper">
	<select id="getTotalCount" parameterType="map" resultType="int">
		select
			count(*)
		from
			investigation
		where
			${searchType} like '%' || #{searchWord} || '%'
	</select>
	
	<select id="selectInvList" parameterType="map" resultType="Investigation">
		select
			investigationnum
			, url
			, title
			, content
			, useremail
			, to_char(regdate, 'YYYY-MM-DD') regdate
			, hitcount
			, recommendation
			, decommendation
		from
			investigation
		where
			${searchType} like '%' || #{searchWord} || '%'
	</select>
	
	<insert id="insertInvestigation" parameterType="Investigation">
		insert into investigation (
			investigationnum
			, url
			, title
			, content
			, useremail
		)values(
			INVESTIGATION_SEQ.nextval
			, #{url}
			, #{title}
			, #{content, jdbcType=VARCHAR}
			, #{useremail}
		)
	</insert>
	
	<select id="selectOneFromInvUseURL" parameterType="Investigation" resultType="Investigation">
		select
			investigationnum
			, url
			, title
			, content
			, useremail
			, to_char(regdate, 'YYYY-MM-DD') regdate
			, hitcount
			, recommendation
			, decommendation
		from
			investigation
		where
			url = #{url}
	</select>
	
	<select id="selectOneFromInvUseNum" parameterType="int" resultType="Investigation">
		select
			investigationnum
			, url
			, title
			, content
			, useremail
			, to_char(regdate, 'YYYY-MM-DD') regdate
			, hitcount
			, recommendation
			, decommendation
		from
			investigation
		where
			investigationnum = #{investigationnum}
	</select>
	<update id="updateHitCount" parameterType="int">
		update
			investigation
		set
			hitcount = hitcount+1
		where
			investigationnum = #{investigationnum}
	</update>
</mapper>