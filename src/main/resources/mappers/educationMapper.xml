<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="global.sesoc.Youtube.dao.EducationMapper">
	<select id="selectEduList" resultType="Education">
		select
			videonum
			, title
			, url
			, originalfile
			, savedfile
			, to_char(regdate, 'YYYY-MM-DD') regdate
			, hitcount
			, recommendation
			, decommendation
		from
			EducationVideo
		order by 
			regdate desc
	</select>
	<select id="selectOneFromEduVideo" parameterType="int" resultType="Education">
		select
			videonum
			, title
			, url
			, originalfile
			, savedfile
			, to_char(regdate, 'YYYY-MM-DD') regdate
			, hitcount
			, recommendation
			, decommendation
		from
			EducationVideo
		where
			videonum = #{videoNum}
	</select>
	<insert id="insertEduVideo" parameterType="Education">
		insert into EducationVideo(
			videonum
			, title
			, url
			, originalfile
			, savedfile
		)values (
			EDUCATION_VIDEO_SEQ.nextval
			, #{title}
			, #{url}
			, #{originalfile}
			, #{savedfile}
		)
	</insert>
	
	<select id="getTotalCount" parameterType="map" resultType="int">
		select
			count(*)
		from 
			EducationVideo
		where
			${searchType} like '%' || #{searchWord} || '%'
	</select>
	
	<update id="updateHitCount" parameterType="int">
		update
			EducationVideo
		set
			hitcount = hitcount+1
		where
			videonum = #{videonum}
	</update>
	
	<select id="selectSubName" parameterType="int" resultType="String">
	select  savedfile
	from EducationVideo
	where videonum=#{value}
	</select>
	
	<select id="dubbingBoard"  resultType="Dubbing">
		select d.dubbingnum, d.title, m.usernick, d.hitcount, d.recommendation, d.decommendation, d.regdate
		from dubbing d, member m
		where d.useremail = m.useremail
		order by d.dubbingnum desc
	</select>
	
	<select id="selectOneDub" parameterType="int" resultType="Dubbing">
		select 
				  d.dubbingnum
			  	, d.title
				, m.usernick
				, d.content
				, d.url
				, d.voiceFile
				, d.hitcount
				, d.recommendation
				, d.decommendation
				, d.regdate
		from dubbing d, member m
		where d.useremail = m.useremail
		and d.dubbingnum = #{dubbingnum}
	</select>
	
	<update id="updateRecomm" parameterType="int">
		update dubbing
		set recommendation = recommendation+1
		where dubbingnum = #{dubbingnum}
	</update>
</mapper>
